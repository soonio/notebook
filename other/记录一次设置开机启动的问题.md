# 服务器环境配置开机启动相关操作

## nginx的开机启动配置

> 文件所在位置 /usr/lib/systemd/system/nginx.service

```
[Unit]
Description=nginx
After=network.target
  
[Service]
Type=forking
ExecStart=/usr/local/nginx/sbin/nginx
ExecReload=/usr/local/nginx/sbin/nginx -s reload
ExecStop=/usr/local/nginx/sbin/nginx -s quit
PrivateTmp=false
  
[Install]
WantedBy=multi-user.target
```

> PrivateTmp为true时，会导致nginx无法启动，待研究

## php-fpm开机启动

```
# 复制源码包中的开启启动配置文件到系统开机启动脚本中
cp php-src-dir/sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm
# 添加可执行权限
chmod +x /etc/init.d/php-fpm
# 设置开机启动
/sbin/chkconfig php-fpm on
# 启动php-fpm服务
systemctl start php-fpm.service
```

## 添加docker开机启动

> systemctl enable docker

## 启动两个开机启动的容器

```
docker run \
    -v /data/mysql/:/var/lib/mysql \
    -p 3306:3306 --name mysql \
    -e MYSQL_ROOT_PASSWORD=123456 \
    --privileged=true \
    --restart unless-stopped \
    --name mysql \
    -d mysql:5.7

docker run --name memcache -d -p 11212:11212 --restart=always memcached
```

